<section id="projects" class="projects-section">
  <div class="container">

    <div class="section-header">
      <span class="section-label mono">{{ 'projects.kicker' | t }}</span>
      <h2 class="section-title">{{ 'projects.title' | t }}</h2>
      <p class="section-description">
        {{ 'projects.description' | t }}
      </p>
    </div>

    <div class="projects-layout">
      <!-- Left: list -->
      <div class="projects-list" role="list">
        @for (project of projects; track trackById($index, project)) {
        <button class="project-item" type="button" role="listitem"
          (mouseenter)="setHover(project.id)" (mouseleave)="setHover(null)" (focus)="setHover(project.id)"
          (blur)="setHover(null)" (click)="openProject(project)" [class.active]="selectedProject?.id === project.id">
          <div class="project-main">
            <h3 class="project-title">
              {{ project.title }}
              <span class="project-arrow" aria-hidden="true">↗</span>
            </h3>

            <div class="technologies mono">
              @for (tech of project.technologies; track tech; let last = $last) {
              <span>
                {{ tech }}{{ !last ? ' | ' : '' }}
              </span>
              }
            </div>
          </div>
        </button>
        }
      </div>

      <!-- Right: hover preview -->
      <div class="preview" aria-hidden="true">
        <div class="preview__frame" [class.is-visible]="previewProject">
          @if (previewProject) {
          <img class="preview__img" [src]="previewProject.imageUrl"
            [alt]="previewProject.title" />
          }
          <div class="preview__hatch"></div>
        </div>
      </div>
    </div>

    <div class="github-cta">
      <a href="https://github.com/milosdimi?tab=repositories" target="_blank" rel="noopener noreferrer" class="mono">
        {{ 'projects.more' | t }} <span class="cta-arrow">↗</span>
      </a>
    </div>
  </div>

  <!-- Modal -->
  @if (selectedProject) {
  <div class="modal" (click)="closeProject()">
    <div class="modal__card" (click)="$event.stopPropagation()" role="dialog" aria-modal="true">
      <button class="modal__close" type="button" (click)="closeProject()" aria-label="Close">×</button>

      <div class="modal__grid">
        <div class="modal__left">
          <div class="modal__number mono">{{ getProjectNumber(selectedProject!.id) }}</div>
          <h3 class="modal__title">{{ selectedProject!.title }}</h3>

          <p class="modal__question mono">{{ 'projects.modal.question' | t }}</p>
          <p class="modal__desc">{{ selectedProject!.descriptionKey | t }}</p>

          <div class="modal__tech">
            @for (tech of selectedProject!.technologies; track tech) {
            <div class="tech">
              @if (getTechIcon(tech); as icon) {
              <img [src]="icon" [alt]="tech" />
              }
              <span class="mono">{{ tech }}</span>
            </div>
            }
          </div>

          <div class="modal__actions">
            <a class="btn btn--outline" [href]="selectedProject!.githubUrl" target="_blank" rel="noopener noreferrer">
              GitHub <span class="btn__arrow">↗</span>
            </a>

            <a class="btn btn--outline btn--accent" [href]="selectedProject!.liveUrl" target="_blank" rel="noopener noreferrer">
              {{ 'projects.modal.live' | t }} <span class="btn__arrow">↗</span>
            </a>
          </div>

        </div>

        <div class="modal__right">
          <div class="modal__media">
            <img class="modal__img" [src]="selectedProject!.imageUrl" [alt]="selectedProject!.title" />
          </div>
          <button class="modal__next mono" type="button" (click)="nextProject()">
            {{ 'projects.modal.next' | t }} <span aria-hidden="true">→</span>
          </button>
        </div>
      </div>
    </div>
  </div>
  }
</section>
